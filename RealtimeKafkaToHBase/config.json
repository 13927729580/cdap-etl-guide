{
  "config": {
    "stages": [
      {
        "name": "kafkaSource",
        "plugin": {
          "name": "Kafka",
          "type": "streamingsource",
          "properties": {
            "topics": "metrics",
            "brokers": "localhost:2181/cdap/kafka",
            "format": "csv",
            "timeField": "readTime",
            "keyField": "key",
            "schema": "{\"type\":\"record\",\"name\":\"metric\",\"fields\":[{\"name\":\"readTime\",\"type\":\"long\"},{\"name\":\"message\",\"type\":\"bytes\"},{\"name\":\"key\",\"type\":[\"string\",\"null\"]}]}"
          }
        }
      },
      {
        "name": "tableSink",
        "plugin": {
          "name": "Table",
          "type": "realtimesink",
          "properties": {
            "name": "metrics",
            "schema": "{\"type\":\"record\",\"name\":\"metric\",\"fields\":[{\"name\":\"message\",\"type\":\"bytes\"},{\"name\":\"key\",\"type\":[\"string\",\"null\"]}]}",
            "schema.row.field": "readTime"
          }
        }
      }
    ],
    "connections": [
      { "from": "kafkaSource", "to": "tableSink" }
    ]
  }
}
