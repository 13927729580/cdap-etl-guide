{
  "config":{
    "schedule":"*/10 * * * *",
    "stages": [
      {
        "name": "streamSource",
        "plugin": {
          "name": "Stream",
          "type": "batchsource",
          "properties": {
            "name": "trades",
            "duration": "10m",
            "format": "csv",
            "schema": "{\"type\":\"record\",\"name\":\"event\",\"fields\":[{\"name\":\"ticker\",\"type\":\"string\"},{\"name\":\"num\",\"type\":\"int\"},{\"name\":\"price\",\"type\":\"double\"}]}",
            "format.setting.delimiter": "|"
          }
        }
      },
      {
        "name": "sink",
        "plugin": {
          "name": "TPFSAvro",
          "type": "batchsink",
          "properties": {
            "schema":"{\"type\":\"record\",\"name\":\"streamEvent\",\"fields\":[{\"name\":\"ts\",\"type\":\"long\"},{\"name\":\"ticker\",\"type\":\"string\"},{\"name\":\"num\",\"type\":\"int\"},{\"name\":\"price\",\"type\":\"double\"}]}",
            "name":"trades_converted"
          }
        }
      },
      {
        "name": "dropHeaders",
        "plugin": {
          "name": "Projection",
          "type": "transform",
          "properties": {
            "drop": "headers"
          }
        }
      }
    ],
    "connections": [
      { "from": "streamSource", "to": "dropHeaders" },
      { "from": "dropHeaders", "to": "sink" }
    ]
  }
}
